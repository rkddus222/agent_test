semantic_models:
  - name: PTD_INS_CRIT
    table: test_daquv('PTD_INS_CRIT')
    description: Semantic model for PTD_INS_CRIT
    entities:
      - name: pdt_cd
        type: primary
        expr: PDT_CD
      - name: plan_cd
        type: primary
        expr: PLAN_CD
      - name: bas_cvg_cd
        type: primary
        expr: BAS_CVG_CD
    dimensions:
      - name: pdt_cd
        type: varchar
        expr: PDT_CD
        label: 상품코드
        description: 상품코드
      - name: plan_cd
        type: varchar
        expr: PLAN_CD
        label: 플랜종류
        description: 플랜종류
      - name: bas_cvg_cd
        type: varchar
        expr: BAS_CVG_CD
        label: 담보코드
        description: 담보코드
      - name: inj_rtn_cd1
        type: varchar
        expr: INJ_RTN_CD1
        label: 상해급수1
        description: 상해급수1
      - name: inj_rtn_cd2
        type: varchar
        expr: INJ_RTN_CD2
        label: 상해급수2
        description: 상해급수2
      - name: injury_grade
        type: varchar
        expr: CASE WHEN INJ_RTN_CD1 = '1' AND INJ_RTN_CD2 = '2' THEN '1~2급' WHEN INJ_RTN_CD1 = '3' AND INJ_RTN_CD2 = '3' THEN '3급' ELSE '기타' END
        label: 상해급수
        description: 상해급수에 따른 분류
    measures:
      - name: start_age
        type: number
        expr: ENT_AG1
        label: 가입연령 min
        description: 가입연령 min
      - name: end_age
        type: number
        expr: ENT_AG2
        label: 가입연령 max
        description: 가입연령 max
      - name: ins_ent_amt1
        type: number
        expr: INS_ENT_AMT1
        label: 가입금액1
        description: 가입금액1
      - name: ins_ent_amt2
        type: number
        expr: INS_ENT_AMT2
        label: 가입금액2
        description: 가입금액2
      - name: ins_ent_amt3
        type: number
        expr: INS_ENT_AMT3
        label: 가입금액3
        description: 가입금액3
      - name: ins_ent_amt4
        type: number
        expr: INS_ENT_AMT4
        label: 가입금액4
        description: 가입금액4
      - name: ins_ent_amt5
        type: number
        expr: INS_ENT_AMT5
        label: 가입금액5
        description: 가입금액5
      - name: ins_ent_amt6
        type: number
        expr: INS_ENT_AMT6
        label: 가입금액6
        description: 가입금액6
      - name: ins_ent_amt7
        type: number
        expr: INS_ENT_AMT7
        label: 가입금액7
        description: 가입금액7
      - name: ins_ent_amt8
        type: number
        expr: INS_ENT_AMT8
        label: 가입금액8
        description: 가입금액8
      - name: ins_ent_amt9
        type: number
        expr: INS_ENT_AMT9
        label: 가입금액9
        description: 가입금액9
      - name: ins_ent_amt10
        type: number
        expr: INS_ENT_AMT10
        label: 가입금액10
        description: 가입금액10
      - name: pdt_cd_count
        type: number
        expr: PDT_CD
        label: 상품코드
        description: 상품코드
metrics:
  - name: total_ptd_ins_crit_count
    metric_type: simple
    type: integer
    expr: COUNT(DISTINCT PTD_INS_CRIT__pdt_cd_count)
    label: 총 PTD_INS_CRIT 수
    description: 총 PTD_INS_CRIT 수
  - name: age_range
    metric_type: simple
    type: integer
    expr: MIN(PTD_INS_CRIT__start_age) || ' ~ ' || MAX(PTD_INS_CRIT__end_age)
    label: Age Range
    description: Minimum start age to maximum end age range
