semantic_models:
  - name: account
    table: test_daquv('account_detail')
    description: 테이블(account_detail)을 기반으로 한 semantic 모델
    defaults:
      agg_time_dimension: test_dt

    entities:
      - name: account
        type: primary
        expr: account_no

    dimensions:
      - name: test_dt
        type: date
        label: 테스트일자
        type_params:
          time_granularity: day
        description: 기본 시간 설정용

      - name: account_name
        type: varchar
        label: 계좌명
        expr: account_name
        description: 계좌명

      - name: account_type
        type: varchar
        expr: account_type
        label: 계좌 종류
        description: 계좌 종류

      - name: open_date
        type: varchar
        label: 개설일자
        expr: open_date
        description: 개설일자

      - name: status
        type: varchar
        expr: status
        label: 계좌 상태
        description: 계좌 상태

    measures:
      - name: account_count
        type: integer
        label: 계좌 수
        description: 계좌 수
        expr: account_no

metrics:
  - name: total_account_count
    description: 총 계좌 수
    type: integer
    metric_type: simple
    label: 총 계좌 수
    expr: COUNT_DISTINCT(account__account_count)